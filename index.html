<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>JS Bin</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
</head>
<body>
<!-- TODO: Se necesita asegurar que el formulario no intenta cargar más archivos que max_file_uploads en una petición. 	 -->
<!-- TODO: Drag and Drop - https://developer.mozilla.org/es/docs/Using_files_from_web_applications --> 
<form enctype="multipart/form-data" method="post" id="fileinfo">
<input type="hidden" name="MAX_FILE_SIZE" value="2000000" />
<input type="file" id="archivos" name="archivos[]" multiple onchange="readImagesAndPreview(this.files);"><p>
<input type="file" id="archivos2" name="archivos2" multiple onchange="readImagesAndPreview(this.files);"><p>
<input type="button" value="Enviar" onclick="presionar()" />
</form>
  <div id="thumbnails"></div>
  <div id="log"></div>
  <script>
    var container = document.getElementById("thumbnails");	
    
    function readImagesAndPreview(files) {
      for(var i=0; i < files.length; i++) {
         var f = files[i];         
         var reader = new FileReader();
        
         reader.onload = function(e) {
           var img = document.createElement("img");		
           img.src = e.target.result;
           img.width = 100;
           img.height = 100;
           container.appendChild(img);
        }
      
        reader.readAsDataURL(f);
      }
    }
	
	function presionar() {
	    var fd = new FormData(document.getElementById('fileinfo'));		
		var request = $.ajax({
		    url: "cargar.php",
            method: "POST",			
            data: fd,
			cache: false,
            processData: false,  
            contentType: false,
			success: function(data) {
			    
			},
			error: function() {
			    alert('Ha ocurrido un error');
			}
        });
        request.done(function( msg ) {
		    if (msg.errors) {
			    $('#log').html(msg.errors);
			} 
			if (msg.success) {
			    $('#log').html(msg.success.msg);
			}
		});
	}
    
  </script>
</body>
</html>